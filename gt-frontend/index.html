<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no" />

    <link data-trunk rel="css" href="bootstrap/css/bootstrap.min.css">
</head>

<body>
    <div id="main"> </div>
    <!-- <script src="./bootstrap.min.js" /> -->
    <script>
        var fileStringReady = false;
        var fileString = "";

        // when the file changes we write it to a global variable that we can get in Haskell
        // and create an ImageBitmap to draw on the canvas
        readFileString = function (evt) {
            console.log("getting new file");
            let file = evt.target.files[0];
            let reader = new FileReader();
            reader.addEventListener('load', function () {
                fileString = reader.result.match(/data:.*?\/.*?;base64,(.*)/)[1];
                fileStringReady = true;
            });
            fileStringReady = false;
            reader.readAsDataURL(file);
        }

        function tryAttachToFile() {
            let inp = document.getElementById('user-picture');
            if (inp) {
                inp.addEventListener('change', readFileString);
            } else {
                attachToFile();
            }
        }

        // when the mutationobserver fires we know that the file input was created
        // as long as we only create new nodes once
        function attachToFile() {
            setTimeout(tryAttachToFile, 100);
        }

        // wait until the window is loaded to start mutationobserver on body
        // could also maybe put the script in the body so that the body exists when it's run
        // window.onload = function () {
        // let observer = new MutationObserver(attachToFile);
        // let target = document.body;
        // let options = { childList: true };
        // observer.observe(target, options);
        // }

        console.log("setup complete");

        function getFileString() {
            fileStringReady = false;
            return fileString;
        }
        function getFileStringReady() {
            return fileStringReady;
        }
    </script>
    <script>
        function scroll_to_end(id) {
            let element = document.getElementById(id);
            if (element) {
                element.scrollLeft = element.scrollWidth;
            }
        }
    </script>
    <script>
        // Configuration for the frontend.
        const JS_BANNER = "引き締めたいカラダのために！";

        const JS_MESSAGE_TIMEOUT = 2000;

        const JS_PAGE_SIZE = 25;

        const JS_LOGO = `data:image/svg+xml;charset=utf-8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 93.35 122.88"><title>man-abs-six-pack</title><path d="M55,1.28a1.2,1.2,0,1,1,2.4-.15A7.81,7.81,0,0,0,58.61,5,7.4,7.4,0,0,0,61.8,7.55a46.46,46.46,0,0,1,6.87,3.07,94.61,94.61,0,0,1,8.4,5.14A21.17,21.17,0,0,1,83.94,19a16.79,16.79,0,0,1,4.81,5.51l0,.05A20.58,20.58,0,0,1,90.54,30a43.19,43.19,0,0,1,.69,7,57.11,57.11,0,0,1,1.94,11.75,106.8,106.8,0,0,1,0,12.77,1.2,1.2,0,1,1-2.39-.12,104.16,104.16,0,0,0,0-12.49,53.41,53.41,0,0,0-1.88-11.35,1.36,1.36,0,0,1-.06-.36,39.14,39.14,0,0,0-.65-6.7,18.31,18.31,0,0,0-1.53-4.77,14.44,14.44,0,0,0-4.13-4.72A18.73,18.73,0,0,0,76.26,18a1.69,1.69,0,0,1-.36-.17,95.63,95.63,0,0,0-8.36-5.13A44.4,44.4,0,0,0,61,9.82l-.16-.06A9.79,9.79,0,0,1,56.61,6.3a10.21,10.21,0,0,1-1.59-5ZM59.5,39a1.31,1.31,0,1,1-1.31,1.31A1.31,1.31,0,0,1,59.5,39Zm-25,0a1.31,1.31,0,1,1-1.3,1.31A1.31,1.31,0,0,1,34.55,39ZM59.06,17.8a1,1,0,0,1,.68,1.88,32.49,32.49,0,0,0-5,2.23,26,26,0,0,0-4.34,3,1,1,0,1,1-1.3-1.51,27.4,27.4,0,0,1,4.67-3.24,34.58,34.58,0,0,1,5.26-2.36ZM34.29,19.68A1,1,0,0,1,35,17.8a34.58,34.58,0,0,1,5.26,2.36A27.58,27.58,0,0,1,44.9,23.4a1,1,0,1,1-1.3,1.52,25.68,25.68,0,0,0-4.34-3,32.49,32.49,0,0,0-5-2.23ZM46,28.09a1,1,0,0,1,2,0V42.88H60.25a21.4,21.4,0,0,0,7-1.84,7.5,7.5,0,0,0,4.29-4.93,1,1,0,1,1,1.94.46,9.37,9.37,0,0,1-5.33,6.26,23.23,23.23,0,0,1-7.7,2l-.18,0c-7.44,0-14.88,0-22.32,0-3.38,0-6.64.06-10-1.16a14,14,0,0,1-4.6-2.7,15.71,15.71,0,0,1-3-3.74,1,1,0,0,1,1.72-1,13.76,13.76,0,0,0,2.62,3.27,12,12,0,0,0,3.95,2.31c3,1.1,6.12,1.07,9.31,1l1.53,0H46V28.09Zm.12,46.47a1,1,0,1,1,2,0v5.85a1,1,0,0,1,.69-.27h5.54c1.1,0,1.88,0,2.54-1a3.28,3.28,0,0,0,.51-1.65,10.05,10.05,0,0,0-.15-2.4,1,1,0,0,1,2-.31,12.32,12.32,0,0,1,.18,2.86,5.33,5.33,0,0,1-.86,2.63c-1.25,1.84-2.48,1.84-4.19,1.83H48.84a1,1,0,0,1-.94-.66,1,1,0,0,1-.75.35,1,1,0,0,1-1-1V74.56Zm-11.4.26a1,1,0,0,1,2,.31,10.05,10.05,0,0,0-.15,2.4,3.28,3.28,0,0,0,.51,1.65c.66,1,1.44,1,2.53,1h5.54a1,1,0,1,1,0,2H39.61c-1.71,0-2.94,0-4.2-1.83a5.33,5.33,0,0,1-.85-2.63,11.8,11.8,0,0,1,.18-2.86ZM46.15,61.76a1,1,0,0,1,2,0v6.46a1,1,0,0,1,.81-.41H54.9c1.2,0,2.05,0,2.78-1A3.79,3.79,0,0,0,58.24,65a11.61,11.61,0,0,0-.16-2.58,1,1,0,0,1,.83-1.15,1,1,0,0,1,1.14.83,13.48,13.48,0,0,1,.19,3,5.67,5.67,0,0,1-.91,2.78c-1.32,1.94-2.62,1.94-4.43,1.93H49A1,1,0,0,1,48,69a1,1,0,0,1-.83.46,1,1,0,0,1-1-1V61.76Zm-12.21.29a1,1,0,0,1,1.14-.83,1,1,0,0,1,.83,1.15A11,11,0,0,0,35.75,65a3.59,3.59,0,0,0,.56,1.81c.72,1.06,1.58,1.06,2.77,1H45a1,1,0,1,1,0,2H39.09c-1.81,0-3.11,0-4.44-1.93a5.56,5.56,0,0,1-.9-2.78,13.48,13.48,0,0,1,.19-3ZM46,47.61a1,1,0,0,1,2,0v8.17a1,1,0,0,1-2,0V47.61Zm14.52,1.14a1,1,0,0,1,2-.31,15.53,15.53,0,0,1,.23,3.66,6.75,6.75,0,0,1-1.06,3.28c-1.55,2.27-3.08,2.26-5.22,2.25H49.26a1,1,0,0,1,0-2h7.22c1.53,0,2.62,0,3.57-1.38a4.8,4.8,0,0,0,.71-2.31,13.67,13.67,0,0,0-.2-3.19Zm-29.4-.31a1,1,0,0,1,2,.31,13.71,13.71,0,0,0-.21,3.19,4.71,4.71,0,0,0,.72,2.31c1,1.4,2,1.39,3.56,1.38h7.23a1,1,0,0,1,0,2H37.22c-2.14,0-3.68,0-5.22-2.25a6.54,6.54,0,0,1-1.06-3.28,15.49,15.49,0,0,1,.22-3.66Zm47.73,73.23a1.2,1.2,0,1,1-2.39,0,145.81,145.81,0,0,0-3.33-31c-8.92,4-16.1,9.92-22.66,17.28-.07,1.54-.12,3.15-.14,4.78,0,2.8,0,5.71,0,8.55a1.2,1.2,0,0,1-2.39,0c0-2.86,0-5.78,0-8.6,0-1,0-1.88.06-2.8H45.51c0,.87.07,1.77.1,2.67.09,2.88.13,5.89.16,8.65a1.2,1.2,0,0,1-1.19,1.21,1.21,1.21,0,0,1-1.21-1.19c0-2.72-.07-5.7-.16-8.6-.05-1.52-.1-3-.18-4.44-6.67-7.87-14-13.67-22.88-17.52a145.88,145.88,0,0,0-3.32,30.93,1.2,1.2,0,0,1-2.4,0A150.43,150.43,0,0,1,19.9,81.51a113.75,113.75,0,0,0,2.6-11.87c.79-5.42.69-5.8-.12-8.75-.26-1-.59-2.16-.95-3.68A44,44,0,0,0,20,52.44c-.2,1.43-.43,2.73-.7,3.91a18.17,18.17,0,0,1-2.33,6A1.2,1.2,0,1,1,15,61a15.75,15.75,0,0,0,2-5.21,59.3,59.3,0,0,0,1.15-8.35A55.33,55.33,0,0,1,14.78,35a1.2,1.2,0,1,1,2.38-.34A57.2,57.2,0,0,0,21,48.33a59.8,59.8,0,0,1,2.76,8.33c.39,1.63.69,2.73.93,3.6.92,3.39,1,3.82.18,9.72A114.92,114.92,0,0,1,22.23,82.1l-.52,2.06A97.5,97.5,0,0,0,50.79,87.5a97,97,0,0,0,20.85-3.24l-.55-2.16A117.49,117.49,0,0,1,68.44,70c-.85-5.9-.74-6.33.19-9.72.24-.87.54-2,.92-3.6a62.56,62.56,0,0,1,2.76-8.33,57.16,57.16,0,0,0,3.86-13.64,1.2,1.2,0,1,1,2.37.34,55.26,55.26,0,0,1-3.3,12.38,60.09,60.09,0,0,0,1.14,8.4,16,16,0,0,0,2,5.21,1.2,1.2,0,0,1-2,1.32,18.17,18.17,0,0,1-2.34-6c-.27-1.2-.5-2.51-.7-4a44.28,44.28,0,0,0-1.45,4.82c-.36,1.51-.69,2.72-1,3.68-.8,3-.91,3.33-.12,8.75a116.2,116.2,0,0,0,2.6,11.86,150.18,150.18,0,0,1,5.47,40.17ZM35.93,1.13a1.2,1.2,0,1,1,2.4.15,10.11,10.11,0,0,1-1.6,5A9.7,9.7,0,0,1,32.5,9.76l-.16.06a44.4,44.4,0,0,0-6.53,2.91,95.63,95.63,0,0,0-8.36,5.13,1.42,1.42,0,0,1-.36.16,18.94,18.94,0,0,0-6.26,2.9A14.44,14.44,0,0,0,6.7,25.64a18.31,18.31,0,0,0-1.53,4.77,39.14,39.14,0,0,0-.65,6.7,1.93,1.93,0,0,1-.06.36A53.41,53.41,0,0,0,2.58,48.82a104.16,104.16,0,0,0,0,12.49,1.2,1.2,0,1,1-2.39.12,106.8,106.8,0,0,1,0-12.77A56.44,56.44,0,0,1,2.12,36.91a43.19,43.19,0,0,1,.69-7,20.58,20.58,0,0,1,1.76-5.41l0-.05A16.67,16.67,0,0,1,9.41,19a21.07,21.07,0,0,1,6.87-3.22,94.61,94.61,0,0,1,8.4-5.14,46.46,46.46,0,0,1,6.87-3.07A7.31,7.31,0,0,0,34.73,5a7.71,7.71,0,0,0,1.2-3.84Z"/></svg>`;
    </script>
</body>

</html>